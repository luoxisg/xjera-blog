<!DOCTYPE html>
<html lang="en">
<%- include('./partials/header.ejs') %>
<body>
  <%- include('./partials/nav.ejs') %>
  
  <div class="content">
    <h2><%= title %></h2>
    <% if (searchQuery) { %>
      <p class="search-result-text">Showing results for: <strong>"<%= searchQuery %>"</strong></p>
    <% } %>

    <% if (blogs.length > 0) { %>
      <div class="blogs-grid">
        <% blogs.forEach(blog => { %>
          <a class="blog-card" href="/blogs/<%= blog._id %>">
            <h3 class="title"><%= blog.title %></h3>
            <p class="author">By: <%= blog.author %></p>
            <p class="snippet"><%= blog.body.substring(0, 100) %>...</p>
            <div class="card-footer">
                <span>Read More</span>
                <span class="date"><%= blog.createdAt.toLocaleDateString() %></span>
            </div>
          </a>
        <% }) %>
      </div>
    <% } else { %>
      <p>There are no blogs to display...</p>
    <% } %>
  </div>

  <!-- Pagination Controls -->
  <% if (totalPages > 1) { %>
    <div class="pagination">
      <% if (currentPage > 1) { %>
        <a href="/blogs?page=<%= currentPage - 1 %>&search=<%= searchQuery %>">« Previous</a>
      <% } %>

      <% for(let i = 1; i <= totalPages; i++) { %>
        <% if (i === currentPage) { %>
          <a href="#" class="active"><%= i %></a>
        <% } else { %>
          <a href="/blogs?page=<%= i %>&search=<%= searchQuery %>"><%= i %></a>
        <% } %>
      <% } %>

      <% if (currentPage < totalPages) { %>
        <a href="/blogs?page=<%= currentPage + 1 %>&search=<%= searchQuery %>">Next »</a>
      <% } %>
    </div>
  <% } %>

  <%- include('./partials/footer.ejs') %>
</body>
</html>